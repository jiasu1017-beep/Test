# 🐴 小马办公 v0.0.3 → v0.0.4 版本差异说明

## 📋 版本信息
- **上一版本**: v0.0.3
- **当前版本**: v0.0.4
- **发布日期**: 2026-02-24

---

## 🔍 主要变更

### ✨ 新增功能

#### 桌面快照筛选系统 ⭐
- **功能描述**: 新增功能完善的筛选系统，支持对应用类型进行精确筛选
- **筛选类别**: 文件夹应用、文档应用、网站应用和程序应用
- **默认设置**: 默认勾选"文件夹应用"和"程序应用"，其他类别默认不选中
- **实时更新**: 筛选条件变更后实时更新快照显示结果

### 🐛 问题修复

#### 1. "快速访问"文件夹路径识别问题
- **问题描述**: 识别到的文件夹应用是"快速访问"时，无法自动获取有效路径
- **解决方案**: 当识别到"快速访问"时，自动提示用户选择具体的文件夹路径
- **修复效果**: 确保所有文件夹应用都有有效的路径，避免添加失败

#### 2. 程序应用无法添加到集合
- **问题描述**: 程序应用类型无法添加到集合中
- **解决方案**: 在 `onAddToCollection` 方法中添加对程序应用类型的处理
- **修复效果**: 确保所有四种应用类型（文件夹、文档、网站、程序）均可添加到集合

#### 3. 筛选隐藏窗口的添加问题
- **问题描述**: 筛选隐藏的窗口仍能被选中和添加
- **解决方案**: 修改 `onSelectAll` 和 `onDeselectAll` 方法，只处理可见窗口
- **修复效果**: 确保只有可见的窗口才能被选中和添加，避免无效操作

#### 4. 桌面快照功能中文件夹应用筛选问题
- **问题描述**: 文件夹应用筛选功能存在缺陷，筛选结果不准确
- **解决方案**: 优化筛选逻辑，确保文件夹应用能正确被识别和筛选
- **修复效果**: 筛选功能在不同文件夹结构下均能准确返回符合预期的结果

### 🔧 性能优化

#### 应用类型检测优化
- **优化内容**: 在 `SnapshotWindowInfo` 中添加 `appType` 字段缓存应用类型
- **优化效果**: 避免重复计算应用类型，提高筛选操作的响应速度
- **性能提升**: 筛选操作不再导致明显的性能下降

### 📁 代码变更

#### 新增文件/方法
- **`onFilterChanged`**: 处理筛选条件变更的槽函数
- **`applyFilters`**: 应用筛选条件，更新表格显示
- **`shouldShowWindow`**: 判断窗口是否应显示的方法

#### 修改文件
- **`desktopsnapshotdialog.cpp`**: 实现筛选功能，修复程序应用添加问题
- **`desktopsnapshotdialog.h`**: 添加筛选相关成员变量和方法声明
- **`main.cpp`**: 更新版本号从 v0.0.3 到 v0.0.4

---

## 🎯 功能对比

| 功能 | v0.0.3 | v0.0.4 | 变更说明 |
|------|--------|--------|----------|
| 应用管理初始化 | ✅ | ✅ | 保持不变 |
| 命令行程序启动 | ✅ | ✅ | 保持不变 |
| 桌面快照筛选系统 | ❌ | ✅ | **新增** |
| "快速访问"路径处理 | ❌ | ✅ | **修复** |
| 程序应用添加到集合 | ❌ | ✅ | **修复** |
| 筛选隐藏窗口处理 | ❌ | ✅ | **修复** |
| 应用类型检测缓存 | ❌ | ✅ | **优化** |

---

## 📥 升级指南

### 从 v0.0.3 升级到 v0.0.4
1. 下载 `release-v0.0.4.zip` 压缩包
2. 解压到任意目录（可覆盖原 v0.0.3 安装目录）
3. 双击运行 `PonyWork.exe` 启动软件

### 注意事项
- **数据兼容性**: v0.0.4 版本与 v0.0.3 版本的数据文件完全兼容，无需迁移
- **依赖项**: 如需使用"检查更新"功能，仍需确保程序目录中包含 OpenSSL 库文件

---

## 📝 测试建议

### 重点测试项
1. **桌面快照筛选功能**
   - 验证四种应用类型的筛选是否正常
   - 测试筛选条件变更后是否实时更新
   - 检查默认筛选状态是否正确（勾选"文件夹应用"和"程序应用"）

2. **文件夹应用路径识别**
   - 测试"快速访问"文件夹的路径选择功能
   - 验证普通文件夹的路径识别是否正常

3. **程序应用添加**
   - 测试程序应用是否能成功添加到集合
   - 验证添加后的程序应用是否能正常启动

4. **筛选隐藏窗口处理**
   - 测试筛选隐藏的窗口是否无法被选中
   - 验证只有可见窗口才能被添加到集合

---

## 🔄 向后兼容性

- **✅ 数据文件**: 完全兼容 v0.0.3 版本的数据文件
- **✅ 配置项**: 所有配置项保持不变
- **✅ 功能接口**: 所有现有功能接口保持兼容
- **✅ 用户数据**: 升级过程中不会丢失任何用户数据

---

## 📞 反馈和支持

如果在升级或使用过程中遇到任何问题，欢迎在 GitHub 提交 Issue：
https://github.com/jiasu1017-beep/Test/issues

---

## 📄 许可证

本软件为免费软件，仅供学习和个人使用。

---

**🎉 感谢您升级到小马办公 v0.0.4！**

*本次更新专注于桌面快照功能的稳定性和用户体验，为您提供更加流畅和可靠的操作体验。*